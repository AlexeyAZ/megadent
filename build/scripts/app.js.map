{"version":3,"sources":["app.js"],"names":["$","addStartClass","el","className","addClass","window","matchMedia","matches","viewportChecker","classToRemove","body","thanksLocation","wlLand","name","length","rangeslider","polyfill","webshim","setOptions","lazyCustomMessages","replaceValidationUI","phoneLink","md","MobileDetect","navigator","userAgent","mobile","attr","data","removeClass","inputmask","greedy","clearIncomplete","onKeyDown","event","buffer","caretPos","opts","on","e","preventDefault","self","target","hasClass","wl","callbacks","onFormSubmit","$form","res","status","smallFormHandler","def","bigFormHandler","submit","formAction","smallFormWrap","document","querySelector","bigFormWrap","openSmallForm","documentElement","classList","add","openBigForm","closeSmallForm","remove","closeBigForm","form","selfName","find","selfPhone","selfEmail","formData","serialize","landUserInfo","val","localStorage","setItem","JSON","stringify","ajax","type","url","success","location","userInfo","getItem","parse","phone","email","thanksPageHandler","isThanksPage","text"],"mappings":"AAAA;;AAEAA,EAAE,YAAW;;AAET,aAASC,aAAT,CAAuBC,EAAvB,EAA0BC,SAA1B,EAAqC;AACjCH,UAAEE,EAAF,EAAME,QAAN,CAAeD,SAAf;AACH;;AAED,QAAG,CAACE,OAAOC,UAAP,CAAkB,mBAAlB,EAAuCC,OAA3C,EAAoD;AAChDN,sBAAc,aAAd,EAA6B,iBAA7B;AACAA,sBAAc,aAAd,EAA6B,iBAA7B;;AAEAD,UAAE,aAAF,EAAiBQ,eAAjB,CAAiC;AAC7BC,2BAAe;AADc,SAAjC;;AAIAT,UAAE,aAAF,EAAiBQ,eAAjB,CAAiC;AAC7BC,2BAAe;AADc,SAAjC;AAGH;;AAID,QAAIC,OAAOV,EAAE,MAAF,CAAX;AACA,QAAIW,iBAAiB,aAArB;AACA,QAAIC,SAAS,KAAb;AACA,QAAIC,IAAJ;;AAEA,QAAIb,EAAE,qBAAF,EAAyBc,MAA7B,EAAqC;AACjCd,UAAE,qBAAF,EAAyBe,WAAzB,CAAqC;AACjCC,sBAAU;AADuB,SAArC;AAGH;;AAEDC,YAAQC,UAAR,CAAmB,OAAnB,EAA4B;AACxBC,4BAAoB,IADI;AAExBC,6BAAqB;AAFG,KAA5B;AAIAH,YAAQD,QAAR,CAAiB,OAAjB;;AAEA,aAASK,SAAT,GAAqB;AACjB,YAAIC,KAAK,IAAIC,YAAJ,CAAiBlB,OAAOmB,SAAP,CAAiBC,SAAlC,CAAT;AACA,YAAIJ,YAAYrB,EAAE,cAAF,CAAhB;;AAEA,YAAIsB,GAAGI,MAAH,EAAJ,EAAiB;AACbL,sBAAUM,IAAV,CAAe,MAAf,EAAuB,SAAS3B,EAAE,aAAF,EAAiB4B,IAAjB,CAAsB,OAAtB,CAAhC;AACAP,sBAAUQ,WAAV,CAAsB,cAAtB;AACH,SAHD,MAGO;AACHR,sBAAUM,IAAV,CAAe,MAAf,EAAuB,EAAvB;AACAN,sBAAUjB,QAAV,CAAmB,cAAnB;AACH;AACJ;AACDiB;;AAEA;;AAEArB,MAAE,mBAAF,EAAuB8B,SAAvB,CAAiC;AAC7B,gBAAQ,iBADqB;AAE7BC,gBAAQ,KAFqB;AAG7BC,yBAAiB,IAHY;AAI7B,sBAAc,YAAU;AACpBhC,cAAE,IAAF,EAAQI,QAAR,CAAiB,eAAjB;AACH,SAN4B;AAO7B6B,mBAAW,UAASC,KAAT,EAAgBC,MAAhB,EAAwBC,QAAxB,EAAkCC,IAAlC,EAAwC;;AAE/C,gBAAIF,OAAOA,OAAOrB,MAAP,GAAgB,CAAvB,MAA8B,GAAlC,EAAuC;AACnCd,kBAAE,IAAF,EAAQ6B,WAAR,CAAoB,eAApB;AACH,aAFD,MAEO;AACH7B,kBAAE,IAAF,EAAQI,QAAR,CAAiB,eAAjB;AACH;AACJ;;AAd4B,KAAjC;;AAkBAM,SAAK4B,EAAL,CAAQ,OAAR,EAAiB,eAAjB,EAAkC,UAASC,CAAT,EAAY;AAC1CA,UAAEC,cAAF;;AAEA,YAAI,CAACxC,EAAE,SAAF,EAAac,MAAlB,EAA0B;AACtBd,cAAE,MAAF,EAAUI,QAAV,CAAmB,WAAnB;AACAJ,cAAE,kBAAF,EAAsBI,QAAtB,CAA+B,gBAA/B;AACH;AACJ,KAPD;;AASAM,SAAK4B,EAAL,CAAQ,OAAR,EAAiB,UAASC,CAAT,EAAY;AACzB,YAAIE,OAAOzC,EAAEuC,EAAEG,MAAJ,CAAX;;AAEA,YAAID,KAAKE,QAAL,CAAc,WAAd,KAA8BF,KAAKE,QAAL,CAAc,aAAd,CAAlC,EAA+D;AAC3D3C,cAAE,MAAF,EAAU6B,WAAV,CAAsB,WAAtB;AACA7B,cAAE,YAAF,EAAgB6B,WAAhB,CAA4B,gBAA5B;AACH;AACJ,KAPD;;AASA,QAAI,OAAOe,EAAP,IAAa,WAAjB,EAA8B;AAC1BhC,iBAAS,IAAT;;AAEAgC,WAAGC,SAAH,CAAaC,YAAb,GAA4B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsB;AAC9C,gBAAID,MAAMnB,IAAN,CAAW,MAAX,CAAJ,EAAwB;;AAEpB,oBAAGoB,IAAIC,MAAJ,IAAc,GAAjB,EAAsB;AAClBC,qCAAiBH,KAAjB;AACH,iBAFD,MAEO;AACHH,uBAAGC,SAAH,CAAaM,GAAb,CAAiBL,YAAjB,CAA8BC,KAA9B,EAAqCC,GAArC;AACH;AACJ,aAPD,MAOO;AACHI,+BAAeL,KAAf;AACH;AACJ,SAXD;AAYH,KAfD,MAeO;AACHnC,iBAAS,KAAT;;AAEAZ,UAAE,yBAAF,EAA6BqD,MAA7B,CAAoC,UAASd,CAAT,EAAY;AAC5CA,cAAEC,cAAF;AACA,gBAAIC,OAAOzC,EAAE,IAAF,CAAX;;AAEAkD,6BAAiBT,IAAjB;AACH,SALD;;AAOAzC,UAAE,UAAF,EAAcqD,MAAd,CAAqB,UAASd,CAAT,EAAY;AAC7BA,cAAEC,cAAF;AACA,gBAAIC,OAAOzC,EAAE,IAAF,CAAX;;AAEAoD,2BAAeX,IAAf;AACH,SALD;AAMH;;AAED,aAASa,UAAT,GAAsB;AAClB,YAAIC,gBAAgBC,SAASC,aAAT,CAAuB,kBAAvB,CAApB;AACA,YAAIC,cAAcF,SAASC,aAAT,CAAuB,gBAAvB,CAAlB;;AAEA,eAAO;;AAEHE,2BAAe,YAAW;AACtBH,yBAASI,eAAT,CAAyBC,SAAzB,CAAmCC,GAAnC,CAAuC,WAAvC;AACAP,8BAAcM,SAAd,CAAwBC,GAAxB,CAA4B,gBAA5B;AACH,aALE;;AAOHC,yBAAa,YAAW;AACpBP,yBAASI,eAAT,CAAyBC,SAAzB,CAAmCC,GAAnC,CAAuC,WAAvC;AACAJ,4BAAYG,SAAZ,CAAsBC,GAAtB,CAA0B,gBAA1B;AACH,aAVE;;AAYHE,4BAAgB,YAAW;AACvBR,yBAASI,eAAT,CAAyBC,SAAzB,CAAmCI,MAAnC,CAA0C,WAA1C;AACAV,8BAAcM,SAAd,CAAwBI,MAAxB,CAA+B,gBAA/B;AACH,aAfE;;AAiBHC,0BAAc,YAAW;AACrBV,yBAASI,eAAT,CAAyBC,SAAzB,CAAmCI,MAAnC,CAA0C,WAA1C;AACAP,4BAAYG,SAAZ,CAAsBI,MAAtB,CAA6B,gBAA7B;AACH;AApBE,SAAP;AAsBH;;AAED,aAASf,gBAAT,CAA0BiB,IAA1B,EAAgC;;AAE5B,YAAIC,WAAWD,KAAKE,IAAL,CAAU,kBAAV,CAAf;AACA,YAAIC,YAAYH,KAAKE,IAAL,CAAU,mBAAV,CAAhB;AACA,YAAIE,YAAYJ,KAAKE,IAAL,CAAU,mBAAV,CAAhB;AACA,YAAIG,WAAWL,KAAKM,SAAL,EAAf;;AAEA,YAAIC,eAAe;AACf,oBAAQN,SAASO,GAAT,EADO;AAEf,qBAASL,UAAUK,GAAV,EAFM;AAGf,qBAASJ,UAAUI,GAAV;AAHM,SAAnB;;AAMAC,qBAAaC,OAAb,CAAqB,cAArB,EAAqCC,KAAKC,SAAL,CAAeL,YAAf,CAArC;;AAEA7D,eAAOuD,SAASO,GAAT,EAAP;;AAEA;;AAEA3E,UAAEgF,IAAF,CAAO;AACHC,kBAAM,MADH;AAEHC,iBAAK,cAFF;AAGHtD,kBAAM4C,QAHH;AAIHW,qBAAS,YAAW;AAChB9E,uBAAO+E,QAAP,GAAkBzE,cAAlB;AACH;AANE,SAAP;AAQA;AACA;AACA;;AAEA,YAAIE,IAAJ,EAAU;AACN+D,yBAAaC,OAAb,CAAqB,gBAArB,EAAuChE,OAAO,QAA9C;AACH,SAFD,MAEO;AACH+D,yBAAaC,OAAb,CAAqB,gBAArB,EAAuC,MAAvC;AACH;AACJ;;AAED,aAASzB,cAAT,CAAwBe,IAAxB,EAA8B;AAC1B,YAAIkB,QAAJ;AACA,YAAIb,QAAJ;;AAEA,YAAII,aAAaU,OAAb,CAAqB,cAArB,CAAJ,EAA0C;AACtCD,uBAAWP,KAAKS,KAAL,CAAWX,aAAaU,OAAb,CAAqB,cAArB,CAAX,CAAX;AACH;;AAEDtF,UAAE,cAAF,EAAkB2E,GAAlB,CAAsBU,SAASxE,IAA/B;AACAb,UAAE,eAAF,EAAmB2E,GAAnB,CAAuBU,SAASG,KAAhC;AACAxF,UAAE,eAAF,EAAmB2E,GAAnB,CAAuBU,SAASI,KAAhC;;AAEAjB,mBAAWL,KAAKM,SAAL,EAAX;;AAEA,YAAI7D,WAAW,KAAf,EAAsB;;AAElBZ,cAAEgF,IAAF,CAAO;AACHC,sBAAM,MADH;AAEHC,qBAAK,qBAFF;AAGHtD,sBAAM4C,QAHH;AAIHW,yBAAS,YAAW;AAChB7B,iCAAaY,YAAb;AACH;AANE,aAAP;AAQH;AACJ;;AAED,aAASwB,iBAAT,GAA6B;;AAEzB,YAAIC,cAAJ,EAAoB;AAChBrC,yBAAaS,WAAb;AACA/D,cAAE,aAAF,EAAiB4F,IAAjB,CAAsBhB,aAAaU,OAAb,CAAqB,gBAArB,CAAtB;AACH;;AAED,iBAASK,YAAT,GAAwB;;AAEpB,gBAAKnC,SAASC,aAAT,CAAuB,SAAvB,CAAL,EAAyC;AACrC,uBAAO,IAAP;AACH,aAFD,MAEO;AACH,uBAAO,KAAP;AACH;AACJ;AACJ;AACDiC;AACH,CAzOD","file":"app.js","sourcesContent":["/*global webshim $ wl MobileDetect*/\r\n\r\n$(function() {\r\n\r\n    function addStartClass(el,className) {\r\n        $(el).addClass(className);\r\n    }\r\n\r\n    if(!window.matchMedia(\"(max-width:768px)\").matches) {\r\n        addStartClass(\".icon-lines\", \"icon-lines_hide\");\r\n        addStartClass(\".sec__decor\", \"sec__decor_hide\");\r\n\r\n        $('.icon-lines').viewportChecker({\r\n            classToRemove: 'icon-lines_hide'\r\n        });\r\n\r\n        $('.sec__decor').viewportChecker({\r\n            classToRemove: 'sec__decor_hide'\r\n        });\r\n    }\r\n\r\n    \r\n\r\n    var body = $(\"body\");\r\n    var thanksLocation = \"thanks.html\";\r\n    var wlLand = false;\r\n    var name;\r\n\r\n    if ($('input[type=\"range\"]').length) {\r\n        $('input[type=\"range\"]').rangeslider({\r\n            polyfill: false,\r\n        });\r\n    }\r\n\r\n    webshim.setOptions('forms', {\r\n        lazyCustomMessages: true,\r\n        replaceValidationUI: true\r\n    });\r\n    webshim.polyfill('forms');\r\n\r\n    function phoneLink() {\r\n        var md = new MobileDetect(window.navigator.userAgent);\r\n        var phoneLink = $(\"[data-phone]\");\r\n\r\n        if (md.mobile()) {\r\n            phoneLink.attr(\"href\", \"tel:\" + $(\".phone-link\").data(\"phone\"));\r\n            phoneLink.removeClass(\"js-small-btn\");\r\n        } else {\r\n            phoneLink.attr(\"href\", \"\");\r\n            phoneLink.addClass(\"js-small-btn\");\r\n        }\r\n    }\r\n    phoneLink();\r\n\r\n    // form handler\r\n\r\n    $(\"input[name=phone]\").inputmask({\r\n        \"mask\": \"+9(999)999-9999\",\r\n        greedy: false,\r\n        clearIncomplete: true,\r\n        \"oncomplete\": function(){\r\n            $(this).addClass(\"input_success\");\r\n        },\r\n        onKeyDown: function(event, buffer, caretPos, opts) {\r\n\r\n            if (buffer[buffer.length - 1] === \"_\") {\r\n                $(this).removeClass(\"input_success\");\r\n            } else {\r\n                $(this).addClass(\"input_success\");\r\n            }\r\n        }\r\n        \r\n    });\r\n\r\n    body.on(\"click\", \".js-small-btn\", function(e) {\r\n        e.preventDefault();\r\n\r\n        if (!$(\".thanks\").length) {\r\n            $(\"html\").addClass(\"form-open\");\r\n            $(\".form-wrap_small\").addClass(\"form-wrap_open\");\r\n        }\r\n    });\r\n\r\n    body.on(\"click\", function(e) {\r\n        var self = $(e.target);\r\n        \r\n        if (self.hasClass(\"form-wrap\") || self.hasClass(\"form__close\")){\r\n            $(\"html\").removeClass(\"form-open\");\r\n            $(\".form-wrap\").removeClass(\"form-wrap_open\");\r\n        } \r\n    });\r\n\r\n    if (typeof wl != \"undefined\") {\r\n        wlLand = true;\r\n\r\n        wl.callbacks.onFormSubmit = function ($form, res) {\r\n            if ($form.data('next')) {\r\n            \r\n                if(res.status == 200) {\r\n                    smallFormHandler($form);\r\n                } else {  \r\n                    wl.callbacks.def.onFormSubmit($form, res);\r\n                }\r\n            } else {\r\n                bigFormHandler($form);\r\n            }\r\n        };\r\n    } else {\r\n        wlLand = false;\r\n\r\n        $(\"#smallForm, #bottomForm\").submit(function(e) {\r\n            e.preventDefault();\r\n            var self = $(this);\r\n\r\n            smallFormHandler(self);\r\n        });\r\n\r\n        $(\"#bigForm\").submit(function(e) {\r\n            e.preventDefault();\r\n            var self = $(this);\r\n\r\n            bigFormHandler(self);\r\n        });\r\n    }\r\n\r\n    function formAction() {\r\n        var smallFormWrap = document.querySelector(\".form-wrap_small\");\r\n        var bigFormWrap = document.querySelector(\".form-wrap_big\");\r\n\r\n        return {\r\n\r\n            openSmallForm: function() {\r\n                document.documentElement.classList.add(\"form-open\");\r\n                smallFormWrap.classList.add(\"form-wrap_open\");\r\n            },\r\n\r\n            openBigForm: function() {\r\n                document.documentElement.classList.add(\"form-open\");\r\n                bigFormWrap.classList.add(\"form-wrap_open\");\r\n            },\r\n\r\n            closeSmallForm: function() {\r\n                document.documentElement.classList.remove(\"form-open\");\r\n                smallFormWrap.classList.remove(\"form-wrap_open\");\r\n            },\r\n\r\n            closeBigForm: function() {\r\n                document.documentElement.classList.remove(\"form-open\");\r\n                bigFormWrap.classList.remove(\"form-wrap_open\");\r\n            },\r\n        }\r\n    }\r\n\r\n    function smallFormHandler(form) {\r\n\r\n        var selfName = form.find(\"input[name=name]\");\r\n        var selfPhone = form.find(\"input[name=phone]\");\r\n        var selfEmail = form.find(\"input[name=email]\");\r\n        var formData = form.serialize();\r\n\r\n        var landUserInfo = {\r\n            \"name\": selfName.val(),\r\n            \"phone\": selfPhone.val(),\r\n            \"email\": selfEmail.val()\r\n        }\r\n\r\n        localStorage.setItem(\"landUserInfo\", JSON.stringify(landUserInfo));\r\n\r\n        name = selfName.val();\r\n\r\n        //if (wlLand === false) {\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: \"php/send.php\",\r\n            data: formData,\r\n            success: function() {\r\n                window.location = thanksLocation;\r\n            }\r\n        });\r\n        // } else {\r\n        //     window.location = thanksLocation;\r\n        // }\r\n\r\n        if (name) {\r\n            localStorage.setItem(\"landclientname\", name + \", наши\");\r\n        } else {\r\n            localStorage.setItem(\"landclientname\", \"Наши\");\r\n        }\r\n    }\r\n\r\n    function bigFormHandler(form) {\r\n        var userInfo;\r\n        var formData;\r\n\r\n        if (localStorage.getItem(\"landUserInfo\")) {\r\n            userInfo = JSON.parse(localStorage.getItem(\"landUserInfo\"));\r\n        }\r\n        \r\n        $(\"[name=name1]\").val(userInfo.name);\r\n        $(\"[name=phone1]\").val(userInfo.phone);\r\n        $(\"[name=email1]\").val(userInfo.email);\r\n\r\n        formData = form.serialize();\r\n\r\n        if (wlLand === false) {\r\n\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: \"php/sendpresent.php\",\r\n                data: formData,\r\n                success: function() {\r\n                    formAction().closeBigForm();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    function thanksPageHandler() {\r\n\r\n        if (isThanksPage()) {\r\n            formAction().openBigForm();\r\n            $(\"#thanksName\").text(localStorage.getItem(\"landclientname\"));\r\n        }\r\n\r\n        function isThanksPage() {\r\n\r\n            if ( document.querySelector(\".thanks\") ) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    thanksPageHandler();\r\n});"]}